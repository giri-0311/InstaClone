{"ast":null,"code":"import React,{useEffect,useState}from'react';import\"./Home.css\";import{useNavigate}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Home(){const navigate=useNavigate();const[data,setdata]=useState([]);useEffect(()=>{const token=localStorage.getItem(\"jwt\");if(!token){navigate(\"./signin\");}//fetching all posts\nfetch(\"/allposts\",{headers:{\"Authorization\":\"Bearer \"+token}}).then(res=>res.json()).then(result=>setdata(result)).catch(err=>console.log(err));},[]);const likePost=id=>{const token=localStorage.getItem(\"jwt\");fetch(\"http://localhost:5004/like\",{method:\"put\",headers:{\"Content-Type\":\"application/json\",\"Authorization\":\"Bearer \"+token},body:JSON.stringify({postId:id})}).then(res=>res.json()).then(result=>{const newData=data.map(posts=>{if(posts._id===result._id){return result;}else{return posts;}});setdata(newData);});};const unlikePost=id=>{const token=localStorage.getItem(\"jwt\");fetch(\"http://localhost:5004/unlike\",{method:\"put\",headers:{\"Content-Type\":\"application/json\",\"Authorization\":\"Bearer \"+token},body:JSON.stringify({postId:id})}).then(res=>res.json()).then(result=>{const newData=data.map(posts=>{if(posts._id===result._id){return result;}else{return posts;}});setdata(newData);});};return/*#__PURE__*/_jsx(\"div\",{className:\"home\",children:data.map(posts=>{return/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-pic\",children:/*#__PURE__*/_jsx(\"img\",{src:\"https://images.unsplash.com/flagged/photo-1570612861542-284f4c12e75f?q=80&w=870&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D\",alt:\"\"})}),/*#__PURE__*/_jsx(\"h5\",{children:posts.postedBy.name})]}),/*#__PURE__*/_jsx(\"div\",{className:\"card-image\",children:/*#__PURE__*/_jsx(\"img\",{src:posts.photo,alt:\"\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-content\",children:[posts.likes.includes(JSON.parse(localStorage.getItem(\"user\"))._id)?/*#__PURE__*/_jsx(\"span\",{className:\"material-symbols-outlined material-symbols-outlined-red\",onClick:()=>{unlikePost(posts._id);},children:\"favorite\"}):/*#__PURE__*/_jsx(\"span\",{className:\"material-symbols-outlined\",onClick:()=>{likePost(posts._id);},children:\"favorite\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"likestext\",children:[posts.likes.length,\" Likes\"]}),/*#__PURE__*/_jsx(\"p\",{children:posts.body})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"add-comment\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"material-symbols-outlined\",children:\"mood\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"add a comment\"}),/*#__PURE__*/_jsx(\"button\",{className:\"comment\",children:\"Post\"})]})]});})});}","map":{"version":3,"names":["React","useEffect","useState","useNavigate","jsx","_jsx","jsxs","_jsxs","Home","navigate","data","setdata","token","localStorage","getItem","fetch","headers","then","res","json","result","catch","err","console","log","likePost","id","method","body","JSON","stringify","postId","newData","map","posts","_id","unlikePost","className","children","src","alt","postedBy","name","photo","likes","includes","parse","onClick","length","type","placeholder"],"sources":["D:/insta-clone/backend/frontend/src/components/Home.js"],"sourcesContent":["import React,{useEffect,useState}  from 'react'\r\nimport \"./Home.css\"\r\nimport {useNavigate} from 'react-router-dom';\r\n\r\nexport default function Home() {\r\n  \r\n  const navigate = useNavigate();\r\n  const [data, setdata] = useState([]);\r\n\r\n  useEffect(() => {\r\n    const token=localStorage.getItem(\"jwt\");\r\n    if(!token){\r\n      navigate(\"./signin\");\r\n    }\r\n\r\n    //fetching all posts\r\n    fetch(\"/allposts\",{\r\n      headers:{\r\n        \"Authorization\":\"Bearer \"+token\r\n      }\r\n    }).then(res => res.json())\r\n    .then(result => setdata(result))\r\n    .catch(err => console.log(err))\r\n\r\n  }, [])\r\n  \r\n\r\n  const likePost = (id)=>{\r\n    const token=localStorage.getItem(\"jwt\");\r\n    fetch(\"http://localhost:5004/like\",{\r\n      method:\"put\",\r\n      headers:{\r\n        \"Content-Type\":\"application/json\",\r\n        \"Authorization\":\"Bearer \"+token\r\n      },\r\n      body:JSON.stringify({\r\n        postId:id\r\n      })\r\n    })\r\n    .then(res=>res.json())\r\n    .then((result)=>{\r\n      const newData=data.map((posts)=>{\r\n        if(posts._id===result._id){\r\n          return result;\r\n        }\r\n        else{\r\n          return posts;\r\n        }\r\n      })\r\n      setdata(newData);\r\n    })\r\n  }\r\n\r\n  const unlikePost = (id)=>{\r\n    const token=localStorage.getItem(\"jwt\");\r\n    fetch(\"http://localhost:5004/unlike\",{\r\n      method:\"put\",\r\n      headers:{\r\n        \"Content-Type\":\"application/json\",\r\n        \"Authorization\":\"Bearer \"+token\r\n      },\r\n      body:JSON.stringify({\r\n        postId:id\r\n      })\r\n    })\r\n    .then(res=>res.json())\r\n    .then((result)=>{\r\n      const newData=data.map((posts)=>{\r\n        if(posts._id===result._id){\r\n          return result;\r\n        }\r\n        else{\r\n          return posts;\r\n        }\r\n      })\r\n      setdata(newData);\r\n    })\r\n  }\r\n\r\n  return (\r\n    <div className=\"home\">\r\n      {/*card*/}\r\n      {data.map((posts)=>{\r\n                    return (\r\n                      <div className=\"card\">\r\n                  {/* card-header */}\r\n                <div className=\"card-header\">\r\n                  <div className=\"card-pic\">\r\n                    <img src=\"https://images.unsplash.com/flagged/photo-1570612861542-284f4c12e75f?q=80&w=870&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D\" alt=\"\" />\r\n                  </div>\r\n                  <h5>{posts.postedBy.name}</h5>\r\n\r\n                </div>\r\n                {/* cardimahe */}\r\n                <div className=\"card-image\">  \r\n                <img src={posts.photo} alt=\"\" />\r\n                </div>\r\n\r\n                {/* card content */}\r\n                <div className=\"card-content\">\r\n                {\r\n                  posts.likes.includes(JSON.parse(localStorage.getItem(\"user\"))._id)?\r\n                <span className=\"material-symbols-outlined material-symbols-outlined-red\" onClick={()=>{unlikePost(posts._id)}}>\r\n            favorite\r\n                </span>\r\n                :\r\n                <span className=\"material-symbols-outlined\"\r\n                onClick={()=>{likePost(posts._id)}}>\r\n            favorite\r\n                </span> \r\n                }\r\n                <p className='likestext'>{posts.likes.length} Likes</p> \r\n                <p>{posts.body}</p>\r\n                \r\n                </div>\r\n                  <div className=\"add-comment\">\r\n                  <span className=\"material-symbols-outlined\">\r\n            mood\r\n            </span>\r\n            <input type=\"text\" placeholder='add a comment' />\r\n            <button className='comment'>Post</button>\r\n                  </div>\r\n\r\n                </div>\r\n        )\r\n      })}\r\n      \r\n    </div>\r\n  )\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}